language: cpp
sudo: required
dist: xenial

addons:
  coverity_scan:
    project:
      name: "PhilInTheGaps/GM-Companion"
      description: "A gamemaster tool."
    notification_email: phil.hoffmann@zoho.eu
    build_command_prepend: qmake
    build_command: make
    branch_pattern: coverity_scan

matrix:
  include:
    - os: linux
      compiler: gcc
      install:
        - ./deploy/travis/install-qt.sh
        - ./deploy/travis/install-dependencies.sh
      script:
        - ./deploy/travis/build-linux.sh
        - ./deploy/travis/build-appimage.sh
        - ./deploy/travis/deploy-appimage.sh
        
    - os: osx
      before_install:
        - brew update
        - brew install qt5 taglib poppler qtkeychain
        - brew link qt5 --force
      script:
        - qmake
        - make

before_script:
  - qmake -version

notifications:
    slack: gm-companion:hYQtgVm2LokcpUT6SbnELwSN
